# scrap_jobs

# -*- coding: utf-8 -*-
"""scrap_jobs.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/16rKIvL20foI3c_AIk0vyb7wauxhWJiP2
"""

import requests
from bs4 import BeautifulSoup
import pandas as pd
import math

def find_no_of_jobs(job):
  req = requests.get ('https://wuzzuf.net/search/jobs/?q='+ job.replace(' ', '%20'))
  soup = BeautifulSoup(req.content, 'lxml')
  jobs = int(soup.find({'strong'}).text.replace(',', ''))
  pages = math.ceil(jobs / 15)
  return jobs, pages

def scrap_pages(query):
    num_jobs, num_pages = find_no_of_jobs(query)
    query = query.replace(' ', '%20')
    titles_lst, links_lst, occupations_lst, companies_lst, specs_lst = [], [], [], [], []
    for pageNo in range(num_pages):
        page = requests.get('https://wuzzuf.net/search/jobs/?a=hpb&q=' + query + '&start=' + str(pageNo))
        soup = BeautifulSoup(page.content, 'lxml')
        titles = soup.find_all("h2", {'class': 'css-m604qf'})
        titles_lst += [title.a.text for title in titles]
        links_lst += ['https://wuzzuf.net' + title.a['href'] for title in titles]
        companies = soup.find_all("a", {'class': 'css-17s97q8'})
        companies_lst += [company.text for company in companies]
        occupations= soup.find_all("div", {'class':"css-1lh32fc"})
        occupations_lst += [occupation.text for occupation in occupations]
        specs= soup.find_all("div", {'class':"css-y4udm8"})
        specs_lst += [spec.a.text for spec in specs]

    scraped_data = {}
    scraped_data['Title'] = titles_lst
    scraped_data['Link'] = links_lst
    scraped_data['Occupation'] = occupations_lst
    scraped_data['Company'] = companies_lst
    scraped_data['Specs'] = specs_lst

    df = pd.DataFrame(scraped_data)
    df.to_csv('mljobs.csv', index=False)
    print("Jobs Scrapped sucessfully")
    return scraped_data, df

def combine_dfs(dfs):
     df = pd.concat(dfs)
     df = df.drop_duplicates()
     return df

def combine_dicts(dicts):
    combined_dict = {}
    for key in dicts[0].keys():
        combined_dict[key] = []
        for dict in dicts:
            combined_dict[key] += dict[key]
    return combined_dict

_,df = scrap_pages('machine learning')

df.head()

_,df = scrap_pages('mechanical engineer')

df.head()

_,df = scrap_pages('Data science')
df.head()

_,df = scrap_pages('Artificial intelligence')
df.head()

ds_dict, ds_df = scrap_pages('Data science')
ml_dict, ml_df = scrap_pages('Machine learning')
ai_dict, ai_df = scrap_pages('Artificial intelligence')

# Combine the data
combined_dict = combine_dicts([ds_dict, ml_dict, ai_dict])
combined_df = combine_dfs([ds_df, ml_df, ai_df])

# Save the data
combined_df.to_csv('data.csv', index=False)

if __name__ == '__main__':
    print('Done')

    combined_dict

    combined_df

    combined_df.to_csv

    ai_dict

    ai_df

    ml_dict

    ml_df

    ds_dict

     ds_df
